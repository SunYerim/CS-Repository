## CPU Scheduling

CPU를 잘 사용하기 위해 프로세스를 잘 배정하기 <br>
`오버헤드 ↓ 사용률 ↑ 기아 현상 ↓`

**목표**✨✨<br>

- **Batch System** : 가능하면 많은 일을 수행 (수행 시간 보다 처리량 중요)
- **Interactive System** : 빠른 응답 시간. 적은 대기 시간
- **Real-time System** : 기한 맞추기

<br>

<img src="https://github.com/user-attachments/assets/79b4f015-75f9-45b9-88a9-585b9c77ad53">

<br>

**프로세스의 상태 전이** <br><br>
✅ **승인(Admitted)** : 프로세스 생성이 가능하여 승인됨 <br>
✅ **스케줄러 디스패치(Scheduler Dispatch)** : 준비 상태에 있는 프로세스 중 하나를 선택하여 실행시키는 것 <br>
✅ **인터럽트(Interrupt)** : 예외, 입출력, 이벤트 등이 발생하여 현재 실행 중인 프로세스를 준비 상태로 바꾸고 해당 작업을 먼저 처리하는 것 <br>
✅ **입출력 또는 이벤트 대기 (I/O or Event wait)** : 입출력/이벤트가 끝난 프로세스를 준비 상태로 전환하여 스케줄러에 의해 선택될 수 있도록 만드는 것

<br><br>

### 선점 / 비선점 스케줄링

---

**선점** <br>
하나의 프로세스가 cpu를 차지하고 있을 때, **우선순위가 높은 다른 프로세스가 현재 프로세스를 중단**시키고 cpu를 점유하는 스케줄링 방식 (처리 시간 예측 어려움) <br>

- **Priority Scheduling**

  - 정적/동적으로 우선순위를 부여하여 우선순위가 높은 순서대로 처리
  - 우선 순위가 낮은 프로세스가 무한정 기다리는 Starvation이 생길 수 있음
  - Aging 방법으로 Starvation 문제 해결 가능

- **Round Robin**

  - FCFS에 의해 프로세스들이 보내지면 각 프로세스는 동일한 시간의 Time Quantum 만큼 CPU를 할당 받음
  - 할당 시간이 크면 FCFS와 같게 되고 작으면 문맥 교환 잦아져서 오버헤드 증가

- **Multilevel-Queue**

  - 작업들을 여러 종류의 그룹으로 나누어 여러 개의 큐를 이용하는 기법
  - 우선순위가 낮은 큐들이 실행 못하는 걸 방지하고자 각 큐마다 다른 Time Quantum을 설정 해주는 방식 사용
  - 우선순위가 높은 큐는 작은 Time Quantum 할당. 우선순위가 낮은 큐는 큰 Time Quantum 할당

- **Multilevel-Feedback-Queue (다단계 피드백 큐)**
  - 다단계 큐에서 자신의 Time Quantum을 다 채운 프로세스는 밑으로 내려가고 자신의 Time Quantum을 다 채우지 못한 프로세스는 원래 큐 그대로
    -> `Time Quantum을 다 채운 프로세스는 CPU burst 프로세스로 판단하기 때문`
  - 짧은 작업에 유리, 입출력 위주 작업에 우선권을 줌
  - 처리 시간이 짧은 프로세스를 먼저 처리하기 때문에 Turnaround 평균 시간을 줄여줌

<br>

**비선점** <br>
한 프로세스가 cpu를 할당받으면 작업 종료 후 cpu 반환 시까지 다른 프로세스는 cpu 점유가 불가능 (처리 시간 예측 용이)

- FCFS (First Come First Served) <br>
  - 큐에 도착한 순서대로 CPU 할당
  - 실행 시간이 짧은 게 뒤로 가면 평균 대기 시간이 길어짐
- SJF (Shortest Job First)
  - 수행 시간이 가장 짧다고 판단되는 작업을 먼저 수행
  - FCFS 보다 평균 대기 시간 감소, 짧은 작업에 유리
- HRN (Hightest Response-ratio Next)
  - 우선순위를 계산하여 점유 불평등을 보완한 방법(SJF의 단점 보완)
  - 우선순위 = (대기 시간 + 실행 시간) / (실행 시간)

<br/><br/>

### 면접 질문 예상

---

<details>
  <summary>스케줄링에 대해 설명해주세요.</summary>
  <br>
  여러 프로세스가 있고, 이 프로세스들이 자원을 동시에 요구하는데 자원은 제한되어 있습니다. 그때 제한된 자원들을 어떻게 나눠줄 것인지에 대한 정책을 말합니다.
</details>

<br>

<details>
  <summary>CPU 스케줄링은 언제 발생합니까?</summary>
  <br>
  실행 상태에서 대기 상태로 전환될 때(예 : 입출력 요청), 실행 상태에서 준비 상태로 전환될 때(예 : 인터럽트 발생), 대기 상태에서 준비상태로 전환될 때(예 : 입출력이 종료될 때), 종료될 때(Terminated)
</details>

<br>

<details>
  <summary>CPU 스케줄링의 목적은 무엇입니까?</summary>
  <br>
  모든 프로세스가 자원을 공평하게 배정받아야 합니다. 자원 배정 과정에서 배제되어서는 안됩니다. 또한 시스템은 유휴 시간(idle)이 없도록 사용되어야 합니다. 시스템 입장에서 유휴 자원은 CPU입니다. 
  <br><br>
  또한 시스템을 강제로 점유하거나 파괴하려는 프로세스로부터 자원을 보호해야 하며, 적절한 시간 안에 프로세스의 요구에 반응해야 합니다.
  <br><br>
  마지막으로 특정 프로세스의 작업이 무한하게 연기되어서는 안 됩니다
</details>
